<!DOCTYPE html>
<html>
<head>
    <title>Debug Viewer</title>
    <style>
        body { margin: 0; background: #111; color: white; font-family: monospace; }
        #info { padding: 20px; }
        #canvas { width: 100%; height: 400px; }
    </style>
</head>
<body>
    <div id="info">Loading...</div>
    <canvas id="canvas"></canvas>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        const info = document.getElementById('info');
        
        // Test 1: Load data
        fetch('data/manifold.json')
            .then(r => r.json())
            .then(data => {
                info.innerHTML = `
                    <h3>Data Loaded Successfully</h3>
                    <p>Trajectory points: ${data.trajectory.length}</p>
                    <p>First position: [${data.trajectory[0].position.join(', ')}]</p>
                    <p>Signals: ${Object.keys(data.signals).length}</p>
                    <p>Source: ${data.metadata?.source}</p>
                `;
                
                // Test 2: Render simple scene
                const canvas = document.getElementById('canvas');
                const scene = new THREE.Scene();
                scene.background = new THREE.Color(0x1a1a2e);
                
                const camera = new THREE.PerspectiveCamera(60, canvas.clientWidth / canvas.clientHeight, 0.1, 100);
                camera.position.set(5, 5, 5);
                camera.lookAt(0, 0, 0);
                
                const renderer = new THREE.WebGLRenderer({ canvas, antialias: true });
                renderer.setSize(canvas.clientWidth, canvas.clientHeight);
                
                // Add lights
                scene.add(new THREE.AmbientLight(0x404040));
                const light = new THREE.DirectionalLight(0xffffff, 1);
                light.position.set(5, 5, 5);
                scene.add(light);
                
                // Draw trajectory as line
                const points = data.trajectory.map(t => new THREE.Vector3(...t.position));
                const lineGeom = new THREE.BufferGeometry().setFromPoints(points);
                const lineMat = new THREE.LineBasicMaterial({ color: 0x3182ce });
                const line = new THREE.Line(lineGeom, lineMat);
                scene.add(line);
                
                // Add a sphere at first point
                const sphere = new THREE.Mesh(
                    new THREE.SphereGeometry(0.1, 16, 16),
                    new THREE.MeshStandardMaterial({ color: 0xff6b6b })
                );
                sphere.position.set(...data.trajectory[0].position);
                scene.add(sphere);
                
                // Grid
                scene.add(new THREE.GridHelper(10, 10, 0x444444, 0x222222));
                
                info.innerHTML += '<p style="color: #4ecdc4;">Three.js rendering OK!</p>';
                
                function animate() {
                    requestAnimationFrame(animate);
                    line.rotation.y += 0.002;
                    sphere.rotation.y += 0.002;
                    renderer.render(scene, camera);
                }
                animate();
            })
            .catch(e => {
                info.innerHTML = `<p style="color: red;">Error: ${e.message}</p>`;
            });
    </script>
</body>
</html>
