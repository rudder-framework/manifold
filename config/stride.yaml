# Window/Stride Configuration - System-Wide
# ============================================
#
# "When five year olds run around - normal noise. When adults start running - regime change."
#
# A regime change is a structural shift that PERSISTS in the anchor window.
# If it bounces back in 21 days, it was volatility - the adults never moved.
#
# HIERARCHICAL APPROACH:
#   - anchor + bridge: ALWAYS run (structural truth + confirmation)
#   - scout + micro: DRILL-DOWN only (when bridge flags displacement)
#
# This configuration applies to ALL layers:
# - Vector (Layer 2): Compute metrics at each window/stride combination
# - Geometry (Layer 3): Compute relational structure at each window/stride
# - State (Layer 4): Compute temporal dynamics at each window/stride

version: "1.1.0"

# Default tiers to run (without drill-down)
default_tiers:
  - anchor
  - bridge

# Drill-down tiers (run when bisection flags displacement)
drilldown_tiers:
  - scout
  - micro

windows:
  anchor:
    window_days: 252
    stride_days: 21
    min_observations: 200
    weight: 4.0
    description: "Structural truth - regime detection (adults)"
    always_run: true

  bridge:
    window_days: 126
    stride_days: 5
    min_observations: 100
    weight: 2.0
    description: "Confirmation layer (teenagers) - early warning"
    always_run: true

  scout:
    window_days: 63
    stride_days: 5
    min_observations: 50
    weight: 1.0
    description: "Drill-down - finer resolution (kids)"
    always_run: false

  micro:
    window_days: 21
    stride_days: 1
    min_observations: 15
    weight: 0.5
    description: "Drill-down - daily dynamics (toddlers)"
    always_run: false

# Bisection drill-down settings
# When displacement exceeds thresholds, automatically drill down to finer resolution
bisection:
  enabled: true
  min_window_days: 16
  thresholds:
    delta_total: 0.3
    delta_pca: 0.15
    delta_clustering: 0.2
    delta_hull: 0.25

# Domain-specific overrides (optional)
# Merge with base windows config when profile is selected
profiles:
  seismology:
    # Seismic events can happen faster
    anchor:
      stride_days: 7
    scout:
      stride_days: 3

# =============================================================================
# DOMAIN-SPECIFIC WINDOW CONFIGURATIONS
# =============================================================================
# Rule of thumb:
#   window = regime_duration / sampling_interval
#   stride = window / 8 to window / 12
#
# These override default windows when domain is specified

domain_windows:
  cmapss:
    window: 50        # ~50 cycles for degradation detection
    stride: 5         # 5-cycle stride
    min_obs: 30
    description: "NASA turbofan engine degradation (per-engine cycles)"

  fd001:
    window: 50        # ~50 cycles for degradation detection
    stride: 5         # 5-cycle stride
    min_obs: 30
    description: "C-MAPSS FD001 - single condition, single fault mode"

  cheme:
    window: 480       # 24 hours of 3-min samples (1 day regime)
    stride: 60        # 3-hour stride
    min_obs: 200
    description: "Chemical engineering (TEP) - 3-min sampling, 24hr regime"

  dynamical:
    window: 500       # Synthetic data - many samples
    stride: 50        # 10% stride
    min_obs: 100
    description: "Synthetic dynamical systems (Lorenz, Rossler)"

  climate:
    window: 60        # 5 years of monthly data
    stride: 12        # 1 year stride
    min_obs: 48
    description: "Climate data - monthly/seasonal patterns"

  ecology:
    window: 52        # 1 year of weekly data
    stride: 4         # 1 month stride
    min_obs: 40
    description: "Ecology data - weekly/seasonal"

  cwru_bearing:
    window: 50        # ~50 samples (each is one test condition)
    stride: 5         # 5-sample stride
    min_obs: 20
    description: "CWRU bearing fault classification - vibration features"

  femto:
    window: 100       # 100 time steps for degradation tracking
    stride: 10        # 10-step stride
    min_obs: 50
    description: "FEMTO bearing run-to-failure - degradation detection"

  hydraulic:
    window: 200       # 200 cycles for health monitoring
    stride: 20        # 20-cycle stride
    min_obs: 100
    description: "UCI Hydraulic system - multi-component monitoring"

  metro:
    window: 30        # 30 days - fits in 7-month dataset
    stride: 7         # Weekly stride
    min_obs: 50000    # ~6 samples/min * 60 * 24 * 30 = 259K per signal
    description: "MetroPT metro train - air production unit (10s sampling)"

  bearing:
    window: 100       # Generic bearing degradation
    stride: 10
    min_obs: 50
    description: "Generic bearing run-to-failure datasets"
